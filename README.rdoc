== Airplane simulation in Ruby on Rails 

 This simulation uses Faye/HTML5 websockets with an OpenLayers geomap interface.

 This was developed in Rails 3 on Windows 7. It places several pinpoints as if
 they where air planes on the map and then moves them around on the map. Ruby Faye/websockets
 are used to move the planes. A couple of processes on the server make the planes move.


== Getting Started

* $ git clone git@github.com:Larzo/airplane-simulation.git

* $ cd airplane-simulation

* Install gems for this rails app:
 
  $ bundle install

* Create database:
   
  $ rake db:migrate

* create airplanes in database:
   
  $ rake db:seed

* Start faye service. Open a new window in the same directory and run

  $ rackup faye.ru -E production -s thin   
   
* Start the rails server, the airplane engine, and the event machine service:
   
  $ rake start_processes   

* open a web brower and go to http://localhost:3000   

== Problems

 It appears that after several minutes or so of pulses over all planes, 
 the clients no longer get the faye subscriptions. 
 Restarting the event machine engine fixes this, so
 it may be tied to that or something specific to the windows environment.

 rake start_processes machine=win 
 causes the the event machine engine to get restarted
 automatically every few minutes, but I am not sure if that
 fixes it quite yet since it is launched as a child process.  
 
 rake start_processes em=false
 causes the rails server and vehicle engine to start, but not
 the event machine service. If you do that, you can the start, kill and restart
 the event machine in a seperate window which does work. The command to do that is:
 
 $ ruby lib\update_map_svc.rb 
  
 I may try to get this app to run on JRuby and see if that has the same problem or not.
  
   
 
 
 

